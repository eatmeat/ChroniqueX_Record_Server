# ChroniqueX Record Server

## Обзор
ChroniqueX Record Server - это настольное приложение, которое обеспечивает возможность аудиозаписи с автоматической обработкой и интеграцией с API ChroniqueX для транскрибации и генерации протоколов.

Для получения API_KEY и пополнения баланса используйте нашего Telegram-бота: [@ChroniqueX_bot](https://t.me/ChroniqueX_bot)

Официальный сайт проекта: [https://www.chroniquex.ru/](https://www.chroniquex.ru/)

## Внешний вид
![Интерфейс ChroniqueX Record Server](img/image.JPG)

## Возможности
- **Аудиозапись**: Высококачественная аудиозапись с возможностью приостановки/продолжения
- **Автоматическая обработка**: Записи автоматически сжимаются в MP3 и отправляются на обработку
- **Веб-интерфейс**: Встроенный веб-интерфейс, доступный через браузер
- **Интеграция с API**: Бесшовная интеграция с API ChroniqueX для транскрибации и генерации протоколов
- **Приложение в трее**: Работает в системном трее с удобными элементами управления
- **Постобработка**: Автоматическая транскрибация и генерация протоколов из записей

## Требования
- Python 3.8+
- Необходимые Python-пакеты (устанавливаются с помощью `pip install -r req.txt`):
  - pyaudiowpatch (запись системного звука, не работает на `Apple` - пока тоьлько микрофон)
  - flask
  - pydub
  - pystray
  - pillow
  - python-dotenv
  - requests
  - pywin32 (только для `Windows`)

## Конфигурация
При первом появится окно с настройками:
- Создать **логин и пароль** для доступа к веб-интерфейсу.
- Ввести **URL и ключ API** для интеграции с сервисом ChroniqueX.

Эти данные автоматически сохраняются в файл `.env` в корневой папке приложения. Вы также можете создать или отредактировать этот файл вручную. Пример содержимого:
```env
CRS_API_URL=https://www.chroniquex.ru:16040
CRS_API_KEY=ваш_ключ_api_здесь
CRS_USERNAME=ваш_логин
CRS_PASSWORD_HASH=хэш_вашего_пароля_генерируется_автоматически
```

## Использование

### Запуск приложения
Запустите приложение с помощью:
```bash
python recordServer.pyw
```

### Веб-интерфейс
После запуска сервер будет доступен по адресу:
- `http://localhost:8288` (порт по умолчанию)

Веб-интерфейс предоставляет:
- Элементы управления записью
- Доступ к записанным файлам
- Мониторинг состояния
- Настройки постобработки 
- Ведение списков участников 

## Рабочий процесс постобработки
1. Аудио записывается и сохраняется как WAV файл
2. WAV файл автоматически конвертируется в MP3
3. Оригинальный WAV файл удаляется после конвертации
4. MP3 файл отправляется в API ChroniqueX для транскрибации
5. Результат транскрибации сохраняется как TXT файл
6. Протокол генерируется из транскрибации и сохраняется как PDF

## Пользовательские промпты
Вы можете настроить генерацию протокола, включив пользовательские промпты в настройках:
- Используйте плейсхолдер `{current_date}` для автоматической вставки даты
- Строки, начинающиеся с `//`, будут игнорироваться при обработке
- HTML файлы в той же директории могут быть включены в контекст по персональным правилам

## Настройка сети
- По умолчанию сервер доступен только локально
- Включите "Доступен по локальной сети" в настройках, чтобы разрешить доступ с других устройств в сети
- Сервер будет доступен по адресу `http://[ваш_ip]:[порт]` с других устройств

## Настройка брандмауэра
- При первом запуске Windows может запросить разрешение на доступ к брандмауэру для Python или для этого приложения
- Убедитесь, что порт 8288 открыт в брандмауэре, если вы планируете использовать доступ по локальной сети
- Для ручной настройки брандмауэра Windows:
  1. Откройте "Брандмауэр Защитника Windows"
  2. Выберите "Разрешить доступ к приложению через брандмауэр"
  3. Нажмите "Добавить порт..."
  4. Укажите:
     - Тип: TCP
     - Порт: 8288
     - Имя: ChroniqueX Record Server
  5. Убедитесь, что галочка установлена для сетей, через которые нужно разрешить доступ (частная, публичная)

## Устранение неполадок
- Если вы сталкиваетесь с ошибками аудиоустройства, убедитесь, что микрофон правильно подключен
- Проверьте, что API_URL и API_KEY в вашем файле `.env` указаны правильно
- Убедитесь, что сервер API ChroniqueX запущен и доступен
- Проверьте вывод консоли на наличие сообщений об ошибках

## Безопасность
- Приложение подключается к API ChroniqueX с использованием HTTPS (шифрование даннсх API осуществляется с помощью SSL-сертификатов)
- Ключи API хранятся в файле `.env` (храните этот файл в безопасности)

## Лицензия
Этот проект лицензирован на условиях лицензии MIT. Подробности см. в файле [LICENSE](LICENSE). Русский перевод находится в файле [LICENSE_RU](LICENSE_RU)
